■はじめに
　・ダウンロードして頂き、ありがとうございます。
　・本ファイルは本プログラムのシステム要件、使い方、注意点などを記載しています。
　・ご使用の前にご一読ください。

■概要
　・このツールは任意のWavファイルをフーリエ変換を利用して、なるべく元ファイルと同じ聞こえ方をするようにMidiへと変換するものです。
　・ある程度の知識があれば、プログラムをいじって自分好みにカスタマイズできます。

■システム要件(動作確認が取れているもの)
　OS：  Windows11
　CPU:  余程古くなければ時間はかかっても動くはず
　RAM:  2GBぐらい使うので、空きが8GBあれば良い(ただし音声データの長さによって変動)

■アンインストール
　・このフォルダごとゴミ箱に捨てればOKです。

■前提ソフト(基本的に最新版でも良いと思われる)
  ・Audacity 3.4.2
  ・Python 3.10.6
  (OmniMIDI 14.8.5)
　(↑正弦波合成できれば基本的に何でもよい)
  ・Midi再生ソフト(おすすめはTom's MIDI Player)

■変換の前に...
  numpyをインストール
  pip install numpy

  midoをインストール
  pip install mido python-rtmidi

■変換方法
　以下の手順を実行してください。
  1. Audacityを起動し、任意の音声ファイルをドラッグアンドドロップした後、音声波形の左下にある"選択"をクリックし、上のタブから トラック→ミックス→ステレオをモノラルにミックスダウン の順に操作します。
　2. 次に、そのWavファイルのデータに対し、EQフィルターで100Hzぐらいから下、4000Hzぐらいから上の範囲の音量が滑らかに減少していくように加工します(参考画像ファイルあり)
  3. さらに、 エフェクト→ピッチとテンポ→テンポを変更 から、下の "高品質な伸縮にチェック" を入れて、変更率を "-93.750" にします。
　4. ファイル→オーディオをエクスポート をクリックし、形式は "WAV (Microsoft)" 、サンプリング周波数は "44100Hz" 、エンコーディングは "Signed 16-bit PCM" にして、
     変換プログラムがあるフォルダに "test.wav" という名前で書き出します。
　5．"start.bat" という名前のバッチファイルを起動します。このとき、同じディレクトリに "test.wav" という名前のファイルがあれば、それが変換されます。無ければエラーで終了します。
　6．フリーズしているわけではないので気長に待ちます。ここでRAMがシステムの限界に近づきすぎるとパソコンがおかしくなる可能性があるので、残り2GBぐらいになってしまったら強制終了させてください。
　7．頑張って待ち続けると、 "test_wav_midi.mid" という名前のmidiファイルが生成され、さらにウィンドウが閉じるのを待つと再生できるようになります。
　8．Tom's MIDI Playerなどで聴きます。

■注意点
  ・1番のEQフィルターをしないと、低音が強すぎたり、高音がうるさかったりすることがあります。
　・1/16倍速された音声データを対象としているので、上記の2番の手順を行わないと、Midiの再生速度が16倍速された状態になります。
  ・サンプリング周波数は44100Hz以外でも変換できますが、良い音で変換できません。上げても下げても質が悪くなります。

　・Midiの再生には"VirtualMIDISynth"や"OmniMIDI"やシンセサイザー等を利用して、正弦波でMidiデータを合成して聴くようにしてください。
   正弦波のサウンドフォントもあるので、よかったら使ってください。

■最後に
　このテキストファイルの内容は修正を加える可能性があります。
　本プログラムは完全無料です。改変は許可しますが、再配布を禁じます。
　本プログラムを使用したことによる如何なる損害について責任は一切負いません。

■参考サイト
  Pythonで音声処理(1)ピー音を作成、グラフ化 ~ Pythonで音声処理(6)音声のキーを変更してみる
  https://truewalk.net/?p=428

  Midoを使ってPythonでMIDIを扱ってみよう
  https://qiita.com/tjsurume/items/75a96381fd57d5350971

最終編集日:2024/04/21

